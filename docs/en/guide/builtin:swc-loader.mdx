import { ApiMeta, Stability } from '../../../components/ApiMeta';

# builtin:swc-loader

<ApiMeta addedVersion="0.3.0" stability={Stability.Experimental} />

`builtin:swc-loader` is the Rust version of [`swc-loader`](https://github.com/swc-project/pkgs/tree/main/packages/swc-loader), aiming to deliver better performance. The Loader's [configuration](https://swc.rs/docs/configuration/compilation) is aligned with the JS version of `swc-loader` (SWC plugins will be provided in future releases and are currently not supported).

If you need to use `builtin:swc-loader` in your project, configure it as follows:

To transpile `ts` files:

```js
module.exports = {
  module: {
    rules: [
      {
        test: /\.ts$/,
        exclude: [/node_modules/],
        loader: 'builtin:swc-loader',
        options: {
          sourceMap: true,
          jsc: {
            parser: {
              syntax: 'typescript',
            },
          },
        },
        type: 'javascript/auto',
      },
    ],
  },
};
```

Or to transpile `jsx` files:

```js
module.exports = {
  module: {
    rules: [
      {
        test: /\.jsx$/,
        use: {
          loader: 'builtin:swc-loader',
          options: {
            sourceMap: true,
            jsc: {
              parser: {
                syntax: 'ecmascript',
                jsx: true,
              },
              transform: {
                react: {
                  pragma: 'React.createElement',
                  pragmaFrag: 'React.Fragment',
                  throwIfNamespace: true,
                  development: false,
                  useBuiltins: false,
                },
              },
            },
          },
        },
        type: 'javascript/auto',
      },
    ],
  },
};
```

Additionally, you can directly refer to [`example-builtin-swc-loader`](https://github.com/web-infra-dev/rspack/tree/main/examples/builtin-swc-loader) for more usage guidelines.

#### options

See [SWC configuration](https://swc.rs/docs/configuration/swcrc).

##### options.rspackExperiments

<ApiMeta stability={Stability.Experimental} addedVersion="0.3.3" />

These fields served as the alternative to the current builtin transform options, aiming to support transforming with respect to the certain module.

For react support, take [`options.jsc.transform.react`](https://swc.rs/docs/configuration/compilation#jsctransformreact) as a reference.

- **Type:**

```ts
export type RspackExperiments = {
  import?: PluginImportOptions;
  emotion?: EmotionOptions;
  relay?: RelayOptions;
  styledComponents?: StyledComponentsOptions;
};
```

- **Default:** `{}`

Some fields can be found in the [builtins](/config/builtins) section:

<ApiMeta stability={Stability.Experimental} addedVersion="0.3.3" />

- [import](/config/builtins#builtinspluginimport)
- [emotion](/config/builtins#builtinsemotion)
- [relay](/config/builtins#builtinsrelay)

And some new features will only provided by `builtin:swc-loader`.

##### options.rspackExperiments.styledComponents

<ApiMeta stability={Stability.Experimental} addedVersion="0.3.7" />

- **Type:**

```ts
type StyledComponentsOptions = {
  displayName?: boolean;
  ssr?: boolean;
  fileName?: boolean;
  meaninglessFileNames?: string[];
  namespace?: string;
  topLevelImportPaths?: string[];
  transpileTemplateLiterals?: boolean;
  minify?: boolean;
  pure?: boolean;
  cssProps?: boolean;
};
```

- **Default:** `{}`

Configure the compile-time support for [styled-components](https://github.com/styled-components/styled-components). SWC's support for styled-components is essentially aligned with the official Babel plugin, so you can visit https://styled-components.com/docs/tooling#babel-plugin for more information.

Usually, you need to enable the JSX support of `builtin:swc-loader` to handle React components. The configuration may look like this:

```js
/** @type {import('@rspack/core').Configuration}*/
module.exports = {
  module: {
    rules: [
      {
        test: /\.jsx?$/,
        loader: 'builtin:swc-loader',
        options: {
          jsc: {
            parser: {
              syntax: 'ecmascript',
              jsx: true,
            },
          },
          rspackExperiments: {
            styledComponents: {
              displayName: true,
              ssr: true,
              fileName: true,
              meaninglessFileNames: ['index', 'styles'],
              namespace: 'rspack-test',
              topLevelImportPaths: [
                '@xstyled/styled-components',
                '@xstyled/styled-components/*',
              ],
              transpileTemplateLiterals: true,
              minify: true,
              pure: true,
              cssProps: true,
            },
          },
        },
      },
    ],
  },
};
```
