# ä» Webpack è¿ç§»

è™½ç„¶ Rspack å°½å¯èƒ½åœ°å…¼å®¹äº† webpack çš„å¸¸ç”¨ APIï¼Œä½†æ˜¯ä¸å¯é¿å…åœ°å­˜åœ¨ä¸€äº›ä¸åŒï¼Œæˆ–æ˜¯ç›¸åŒçš„åŠŸèƒ½åœ¨ Rspack ä¸­æœ‰æ›´é«˜æ€§èƒ½çš„å®ç°æ–¹å¼ã€‚

> å¯¹æ¯” webpack 5.

> ğŸŸ© : æ”¯æŒ
>
> ğŸŸ¥ : ä¸æ”¯æŒ
>
> ğŸŸ§ : éƒ¨åˆ†æ”¯æŒ

## Entry

- string ğŸŸ©
- string[] ğŸŸ©
- EntryObject ğŸŸ§

  - `import: EntryItem` ğŸŸ©
  - `runtime?: string | false` ğŸŸ©
  - ...others ğŸŸ¥

- Function ğŸŸ¥

## Context ğŸŸ©

## Mode ğŸŸ©

## Output

Others

### Output.assetModuleFilename ğŸŸ§

- string ğŸŸ©
- function ğŸŸ¥

### Output.filename ğŸŸ§

- string ğŸŸ©
- function ğŸŸ¥

### Output.chunkFilename ğŸŸ§

- string ğŸŸ©
- function ğŸŸ¥

### Output.cssFilename ğŸŸ§

- string ğŸŸ©
- function ğŸŸ¥

### Output.cssChunkFilename ğŸŸ§

- string ğŸŸ©
- function ğŸŸ¥

### Output.path ğŸŸ©

- string

### Output.publicPath ğŸŸ§

- string ğŸŸ©
- function ğŸŸ¥

### Output.strictModuleErrorHandling ğŸŸ©

- boolean

### Output.[...others] ğŸŸ¥

### Template strings ğŸŸ§

#### Compilation-level ğŸŸ§

- [fullhash] ğŸŸ©
- [hash] ğŸŸ¥

#### Chunk-level ğŸŸ©

- [id] ğŸŸ©
- [name] ğŸŸ©
- [chunkhash] ğŸŸ©
- [contenthash] ğŸŸ©

#### Module-level ğŸŸ§

- [id] ğŸŸ©
- [moduleid] ğŸŸ¥
- [hash] ğŸŸ©
- [modulehash] ğŸŸ¥
- [contenthash] ğŸŸ©

#### File-level ğŸŸ§

- [file] ğŸŸ¥
- [query] ğŸŸ©
- [fragment] ğŸŸ¥
- [base] ğŸŸ¥
- [filebase] ğŸŸ¥
- [path] ğŸŸ©
- [name] ğŸŸ©
- [ext] ğŸŸ©

#### URL-level ğŸŸ¥

- [url] ğŸŸ¥

## Module

### Module.generator ğŸŸ¥

### Module.parser ğŸŸ§

### Rule

#### Rule Condition ğŸŸ§

- string ğŸŸ©
- RegExp ğŸŸ©
- function ğŸŸ¥

#### Rule.exclude ğŸŸ©

#### Rule.include ğŸŸ©

#### Rule.loaders ğŸŸ©

æ¨èä½¿ç”¨ `Rule.use`ã€‚

#### Rule.parse ğŸŸ©

- dataUrlCondition ğŸŸ©

#### Rule.generator ğŸŸ§

- filename ğŸŸ©
- dataUrl ğŸŸ¥
- emit ğŸŸ¥
- publicPath ğŸŸ¥
- outputPath ğŸŸ¥

#### Rule.resource ğŸŸ©

#### Rule.resourceQuery ğŸŸ©

#### Rule.sideEffects ğŸŸ©

#### Rule.test ğŸŸ©

#### Rule.type ğŸŸ§

- asset/resource ğŸŸ©
- asset/inline ğŸŸ©
- asset/source ğŸŸ©
- asset ğŸŸ©

Other types supported by Rspack:

- javascript/auto
- typescript
- css
- css/module
- json

#### Rule.use ğŸŸ§

- useEntry ğŸŸ©
- function ğŸŸ¥

#### Rule.resolve ğŸŸ§

#### Rule.[...others] ğŸŸ¥

## Resolve

### Resolve.alias ğŸŸ©

### Resolve.aliasField ğŸŸ§

ç±»å‹å·®å¼‚:

- webpack: `string[]`
- Rspack: `Boolean`

### Resolve.conditionNames ğŸŸ©

### Resolve.extensions ğŸŸ§

é»˜è®¤å€¼ä¸åŒ:

- webpack: `['.js', '.json', '.wasm']`
- rspack: `['.tsx', '.jsx', '.ts', '.js', '.json', '.d.ts']`

### Resolve.fallback ğŸŸ©

### Resolve.mainFields ğŸŸ©

### Resolve.mainFiles ğŸŸ©

### Resolve.modules ğŸŸ©

### Resolve.preferRelative ğŸŸ©

### Resolve.[...others] ğŸŸ¥

## Optimization

### Optimization.moduleIds ğŸŸ§

- natural ğŸŸ¥
- named ğŸŸ©
- deterministic ğŸŸ©
- size ğŸŸ¥

### Optimization.minimize ğŸŸ©

### Optimization.minimizer ğŸŸ§ ???

- plugins[] ğŸŸ©
- function ğŸŸ¥

### Optimization.removeAvailableModules ğŸŸ§

é»˜è®¤å€¼ä¸åŒ:

- webpack: ä»… production æ¨¡å¼ä¸‹ä¸º `true`
- rspack: é»˜è®¤éƒ½ä¸º `true`

### Optimization.removeEmptyChunks ğŸŸ©

### Optimization.runtimeChunk ğŸŸ§

- object ğŸŸ¥
- string ğŸŸ¥
- boolean ğŸŸ©

### Optimization.sideEffects ğŸŸ©

### Optimization.splitChunks ğŸŸ§

_é»˜è®¤å€¼å®Œå…¨ç›¸åŒã€‚_

#### splitChunks.automaticNameDelimiter ğŸŸ©

#### splitChunks.chunks ğŸŸ©

#### splitChunks.maxAsyncRequests ğŸŸ©

#### splitChunks.maxInitialRequests ğŸŸ©

#### splitChunks.defaultSizeTypes ğŸŸ©

#### splitChunks.minChunks ğŸŸ©

#### splitChunks.hidePathInfo

#### splitChunks.minSize ğŸŸ§

- number ğŸŸ©
- object ğŸŸ¥

#### splitChunks.minSizeReduction ğŸŸ§

- number ğŸŸ©
- object ğŸŸ¥

#### splitChunks.enforceSizeThreshold ğŸŸ©

#### splitChunks.minRemainingSize ğŸŸ©

#### splitChunks.layer ğŸŸ¥

#### splitChunks.maxSize ğŸŸ©

#### splitChunks.maxAsyncSize ğŸŸ©

#### splitChunks.maxInitialSize ğŸŸ©

#### splitChunks.name ğŸŸ©

#### splitChunks.usedExports ğŸŸ¥

#### splitChunks.cacheGroups ğŸŸ§

## Plugins

ä¸€äº›æ’ä»¶å¯ä»¥è¢«å†…ç½®åŠŸèƒ½å–ä»£: [plugin-compat](/guide/plugin-compat).

æ”¯æŒçš„æ’ä»¶ api : [plugin-api](/api/plugin-api)

### DefinePlugin ğŸŸ©

ä½¿ç”¨ `builtins.define`

### html-webpack-plugin ğŸŸ©

Rspack å†…ç½®äº†å¯¹ html çš„æ”¯æŒï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ `builtins.html` æ¥ä»£æ›¿ html-webpack-pluginã€‚

```diff
 const HtmlWebpackPlugin = require("html-webpack-plugin");

 module.exports = {
+  builtins: {
+    html: [
+      {
+        template: "index.html",
+        filename: "index.html",
+      },
+    ],
+  },
-  plugins: [
-    new HtmlWebpackPlugin({
-      template: "index.html",
-      filename: "index.html",
-    }),
-  ],
 };
```

## Loaders

### ç§»é™¤ babel-loader

Rspack å·²ç»å†…ç½®äº†å¯¹ TypeScriptã€JSX ä»¥åŠæœ€æ–°çš„ JavaScript è¯­æ³•çš„æ”¯æŒï¼Œè¿™æ„å‘³ç€å¦‚æœä½ çš„ babel-loader åªæ˜¯ä¸ºäº†æ”¯æŒ TypeScriptã€JSX ä»¥åŠæ›´æ–°çš„ JavaScript è¯­æ³•ï¼Œé‚£ä¹ˆå®Œå…¨å¯ä»¥ç§»é™¤ babel-loaderã€‚

å¦‚æœä½ çš„ babel-loader æ˜¯ä¸ºäº†æ”¯æŒè‡ªå®šä¹‰çš„è½¬æ¢é€»è¾‘ï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†çš„ babel-loader å¯ä»¥ä¿ç•™ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸é¼“åŠ±ç”¨æˆ·å¯¹å¤§é‡çš„æ–‡ä»¶ä½¿ç”¨ babel-loaderï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´ä¸¥é‡çš„æ€§èƒ½æ¶åŒ–ã€‚

```diff
 module.exports = {
   module: {
-    rules: [
-      {
-        test: /\.tsx?$/i,
-        use: [
-          {
-            loader: 'babel-loader',
-            options: {
-              presets: ['@babel/preset-typescript'],
-            },
-          },
-        ],
-        test: /\.jsx?$/i,
-        use: [
-          {
-            loader: 'babel-loader',
-            options: {
-              presets: ['@babel/preset-react'],
-            },
-          },
-        ],
-      },
-    ],
   },
 };
```

åŒæ—¶ï¼ŒRspack è¿˜é»˜è®¤æ”¯æŒäº† JavaScript è¯­æ³•é™çº§çš„åŠŸèƒ½ï¼Œè¿™æ„å‘³ç€ä½ ä¸éœ€è¦å†ä½¿ç”¨ babel-loader æ¥å¤„ç†æµè§ˆå™¨å…¼å®¹æ€§ï¼Œä½ å¯ä»¥é€šè¿‡ [target](/config/target) å’Œ [builtins.presetEnv](/config/builtins#builtinspresetenv) æ¥æŒ‡å®šæµè§ˆå™¨å…¼å®¹èŒƒå›´ã€‚

```diff
 module.exports = {
+  builtins: {
+    presetEnv: {
+      targets: ['es5'],
+    },
+  },
+  target: ['web', 'es5'],
   module: {
     rules: [
-      {
-        test: /\.jsx?$/i,
-        use: [
-          {
-            loader: 'babel-loader',
-            options: {
-              presets: ['@babel/preset-env'],
-            },
-          },
-        ],
-      },
     ],
   },
 };
```

### ç§»é™¤ css-loader å’Œ style-loader å’Œ mini-css-extract-plugin

Rspack å†…ç½®æ”¯æŒäº† css æ¨¡å—ç±»å‹ ï¼ŒåŸç”Ÿ css æ¨¡å—ç±»å‹å†…ç½®äº†å¯¹ cssã€css hmrã€css module ä»¥åŠ css æå–åŠŸèƒ½çš„æ”¯æŒï¼Œè¿™æ„å‘³ç€ä½ ä¸éœ€è¦å†ä¸º css æ–‡ä»¶å•ç‹¬é…ç½® css-loaderã€style-loader å’Œ mini-css-extract-pluginã€‚

```diff
-const MiniCssExtractPlugin = require("mini-css-extract-plugin");

 module.exports = {
   module: {
     rules: [
-      {
-        test: /\.css$/i,
-        use: [
-          isDev ? "style-loader" : MiniCssExtractPlugin.loader,
-          "css-loader",
-        ],
-      },
+      {
+        test: /\.css$/i,
+        type: "css", // this is enabled by default for .css, so you don't need to specify it
+      },
     ],
   },
   plugins: [],
 };
```

å¯¹äº [css-modules](https://github.com/css-modules/css-modules) çš„åŠŸèƒ½ï¼Œé€šè¿‡æŒ‡æ˜ css/module ä½œä¸ºæ¨¡å—ç±»å‹å³å¯å¼€å¯ã€‚

```diff
 module.exports = {
   module: {
     rules: [
+      {
+        test: /\.module\.css$/i,
+        type: "css/module", // this is enabled by default for module.css,   so you don't need to specify it
+      },
     ],
   },
 };
```

### ä½¿ç”¨ Asset Modules æ¥ä»£æ›¿ file-loaderã€url-loader å’Œ raw-loader

Rspack å¯¹é½ webpack 5 çš„ Asset Modulesï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ Asset Modules æ¥ä»£æ›¿ file-loader å’Œ url-loaderã€‚

```diff
 module.exports = {
   module: {
     rules: [
+      {
+        test: /\.(png|jpe?g|gif)$/i,
+        type: "asset/resource",
+      },
+      {
+        test: /^BUILD_ID$/,
+        type: "asset/source",
+      },
-      {
-        test: /\.(png|jpe?g|gif)$/i,
-        use: ["file-loader"],
-      },
-      {
-        test: /^BUILD_ID$/,
-        use: ["raw-loader",],
-      },
     ],
   },
 };
```

## DevServer ğŸŸ§

// todo

## Cache ğŸŸ¥

rspack åªæ”¯æŒè®¾ç½®ä¸ºå¸ƒå°”å€¼ã€‚

## Devtool ğŸŸ©

## Target ğŸŸ§

- async-node[[X].Y] ğŸŸ¥
- electron[[X].Y]-main ğŸŸ¥
- electron[[X].Y]-renderer ğŸŸ¥
- electron[[X].Y]-preload ğŸŸ¥
- node[[X].Y] ğŸŸ§
  - `node`
- node-webkit[[X].Y] ğŸŸ¥
- nwjs[[X].Y] ğŸŸ¥
- web ğŸŸ©
- webworker ğŸŸ§
  - æ”¹ä¸º `web-worker`
- esX ğŸŸ©
- browserslist ğŸŸ©

## Watch and WatchOptions ğŸŸ§

### Watch ğŸŸ©

### WatchOptions.aggregateTimeout ğŸŸ¥

### WatchOptions.ignored ğŸŸ©

### WatchOptions.poll ğŸŸ©

### WatchOptions.followSymlinks ğŸŸ¥

### WatchOptions.stdin ğŸŸ¥

## Externals ğŸŸ§

- string ğŸŸ©
- object ğŸŸ©
- function ğŸŸ¥
- RegExp ğŸŸ¥
- [] ğŸŸ¥

### ExternalsType ğŸŸ§

- commonjs ğŸŸ©
- global ğŸŸ©
- module ğŸŸ©
- promise ğŸŸ¥
- self ğŸŸ©
- script ğŸŸ¥
- this ğŸŸ©
- var ğŸŸ©
- window ğŸŸ©

rspack é¢å¤–æ”¯æŒçš„å±æ€§:

- amd
- amd-require
- import
- jsonp
- node-commonjs
- system
- umd
- umd2

## Performance ğŸŸ¥

## Node ğŸŸ§

### Node.global ğŸŸ©

### Node.\_\_dirname ğŸŸ©

### Node.\_\_filename ğŸŸ¥

## Stats ğŸŸ§

// todo

## Experiments ğŸŸ¥

è™½ç„¶éƒ½æœ‰ `experiments` é…ç½®é¡¹ï¼Œä½†ä¸¤è€…çš„å®éªŒåŠŸèƒ½å®Œå…¨ä¸åŒï¼Œæ‰€ä»¥ä¸è¦åœ¨ rspack ä¸­é…ç½® webpack çš„å®éªŒåŠŸèƒ½ã€‚
